<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="generator" content="pandoc" />
  <title></title>
  <style type="text/css">code{white-space: pre;}</style>
  <style type="text/css">
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; }
code > span.dt { color: #902000; }
code > span.dv { color: #40a070; }
code > span.bn { color: #40a070; }
code > span.fl { color: #40a070; }
code > span.ch { color: #4070a0; }
code > span.st { color: #4070a0; }
code > span.co { color: #60a0b0; font-style: italic; }
code > span.ot { color: #007020; }
code > span.al { color: #ff0000; font-weight: bold; }
code > span.fu { color: #06287e; }
code > span.er { color: #ff0000; font-weight: bold; }
  </style>
  <script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>
</head>
<body>
<h1 id="the-inverse-z-transform">The Inverse Z-Transform</h1>
<p>Dr Chris Jobling (<script type="text/javascript">
<!--
h='&#x73;&#x77;&#x61;&#110;&#x73;&#x65;&#x61;&#46;&#x61;&#x63;&#46;&#x75;&#x6b;';a='&#64;';n='&#x63;&#46;&#112;&#46;&#106;&#x6f;&#98;&#108;&#x69;&#110;&#x67;';e=n+a+h;
document.write('<a h'+'ref'+'="ma'+'ilto'+':'+e+'" clas'+'s="em' + 'ail">'+e+'<\/'+'a'+'>');
// -->
</script><noscript>&#x63;&#46;&#112;&#46;&#106;&#x6f;&#98;&#108;&#x69;&#110;&#x67;&#32;&#x61;&#116;&#32;&#x73;&#x77;&#x61;&#110;&#x73;&#x65;&#x61;&#32;&#100;&#x6f;&#116;&#32;&#x61;&#x63;&#32;&#100;&#x6f;&#116;&#32;&#x75;&#x6b;</noscript>)</p>
<p>Digital Technium 123</p>
<p>Office Hours: 12:00-13:00 Mondays</p>
<p>You can view the notes for this presentation in <a href="http://cpjobling.github.io/EG-247-Resources/week10/i-z-transform.html">HTML</a> and <a href="http://cpjobling.github.io/EG-247-Resources/week10/i-z-transform.pdf">PDF</a>.</p>
<p>The source code of this presentation is available in Markdown format from GitHub: <a href="https://github.com/cpjobling/EG-247-Resources/tree/master/week10/i-z-transform.md">i-z-transform.md</a>.</p>
<p>The GitHub repository <a href="https://github.com/cpjobling/EG-247-Resources">EG-247 Resources</a> also contains the source code for all the Matlab/Simulink examples and the Laboratory Exercises.</p>
<h2 id="scope-and-background-reading">Scope and Background Reading</h2>
<p>This session we will talk about the Inverse Z-Transform and illustrate its use through an examples class.</p>
<p>The material in this presentation and notes is based on Chapter 9 (Starting at Section 9.6) of <a href="http://site.ebrary.com/lib/swansea/docDetail.action?docID=10547416">Steven T. Karris, Signals and Systems: with Matlab Computation and Simulink Modelling, 5th Edition.</a> from the <strong>Required Reading List</strong>.</p>
<h2 id="agenda">Agenda</h2>
<ul>
<li>Inverse Z-Transform</li>
<li>Examples using PFE</li>
<li>Examples using Long Division</li>
<li>Analysis in Matlab</li>
</ul>
<h2 id="the-inverse-z-transform-1">The Inverse Z-Transform</h2>
<p>The inverse Z-Transform enables us to extract a sequence <span class="math">\(f[n]\)</span> from <span class="math">\(F(z)\)</span>. It can be found by any of the following methods:</p>
<ul>
<li>Partial fraction expansion</li>
<li>The inversion integral</li>
<li>Long division of polynomials</li>
</ul>
<h1 id="partial-fraction-expansion">Partial fraction expansion</h1>
<h2 id="partial-fraction-expansion-1">Partial fraction expansion</h2>
<p>We expand <span class="math">\(F(z)\)</span> into a summation of terms whose inverse is known. These terms have the form:</p>
<p><span class="math">\[k,\;\frac{r_1 z}{z - p_1},\;\frac{r_1 z}{(z - p_1)^2},\;\frac{r_3 z}{z -
p_2},\ldots\]</span></p>
<p>where <span class="math">\(k\)</span> is a constant, and <span class="math">\(r_i\)</span> and <span class="math">\(p_i\)</span> represent the residues and poles respectively, and can be real or complex <a href="#fn1" class="footnoteRef" id="fnref1"><sup>1</sup></a></p>
<div class="notes">
<p><strong>Notes</strong></p>
<span class="math">\[\frac{r_{i} z}{z - p_i} + \frac{r_{i}^* z}{z - p_i^*}\]</span>
</div>
<h2 id="step-1-make-fractions-proper">Step 1: Make Fractions Proper</h2>
<ul>
<li>Before we expand <span class="math">\(F(z)\)</span> into partial fraction expansions, we must first express it as a <em>proper</em> rational function.</li>
<li>This is done by expanding <span class="math">\(F(z)/z\)</span> instead of <span class="math">\(F(z)\)</span></li>
<li>That is we expand</li>
</ul>
<p><span class="math">\[\frac{F(z)}{z} = \frac{k}{z} + \frac{r_1}{z-p_1} + \frac{r_2}{z-p_2} +
\cdots\]</span></p>
<h2 id="step-2-find-residues">Step 2: Find residues</h2>
<ul>
<li>Find residues from</li>
</ul>
<p><span class="math">\[r_k = \lim_{z\to p_k}(z - p_k)\frac{F(z)}{z} = (z -
p_k)\left.\frac{F(z)}{z}\right|_{z=p_k}\]</span></p>
<h2 id="step-3-map-back-to-transform-tables-form">Step 3: Map back to transform tables form</h2>
<ul>
<li>Rewrite <span class="math">\(F(z)/z\)</span>:</li>
</ul>
<p><span class="math">\[z\frac{F(z)}{z} = F(z) = k + \frac{r_1z}{s-p_1} + \frac{r_2z}{s-p_2} +
\cdots\]</span></p>
<h2 id="example-1">Example 1</h2>
<p>Karris Example 9.4: use the partial fraction expansion to compute the inverse z-transform of</p>
<p><span class="math">\[F(z) = \frac{1}{(1 - 0.5z^{-1})(1 - 0.75z^{-1})(1 - z^{-1})}\]</span></p>
<h2 id="answer-to-example-1">Answer to Example 1</h2>
<p><span class="math">\[f[n] = 2\left(\frac{1}{2}\right)^n - 9\left(\frac{3}{4}\right)^n + 8\]</span></p>
<h2 id="matlab-solution">Matlab solution</h2>
<p>See <a href="https://github.com/cpjobling/EG-247-Resources/blob/master/week10/matlab/example1.m">example1.m</a></p>
<p>Uses Matlab functions:</p>
<ul>
<li><code>collect</code> – expands a polynomial</li>
<li><code>sym2poly</code> – converts a polynomial into a numeric polymial (vector of coefficients in descending order of exponents)</li>
<li><code>residue</code> – calculates poles and zeros of a polynomial</li>
<li><code>ztrans</code> – symbolic z-transform</li>
<li><code>iztrans</code> – symbolic inverse ze-transform</li>
<li><code>stem</code> – plots sequence as a &quot;lollipop&quot; diagram</li>
</ul>
<h2 id="stem-lollipop-plot">Stem (&quot;Lollipop&quot;) Plot</h2>
<div class="figure">
<img src="pictures/example1.png" alt="Solution to Example 1" /><p class="caption">Solution to Example 1</p>
</div>
<h2 id="example-2">Example 2</h2>
<p>Karris example 9.5: use the partial fraction expansion method to to compute the inverse z-transform of</p>
<p><span class="math">\[F(z) = \frac{12z}{(z+1)(z - 1)^2}\]</span></p>
<h2 id="answer-to-example-2">Answer to Example 2</h2>
<p><span class="math">\[f[n] = 3(-1)^n + 6n - 3\]</span></p>
<h2 id="matlab-solution-1">Matlab solution</h2>
<p>See <a href="https://github.com/cpjobling/EG-247-Resources/blob/master/week10/matlab/example2.m">example2.m</a></p>
<p>Uses additional Matlab functions:</p>
<ul>
<li><code>dimpulse</code> – computes and plots a sequence <span class="math">\(f[n]\)</span> for any range of values of <span class="math">\(n\)</span></li>
</ul>
<h2 id="lollipop-plot">Lollipop Plot</h2>
<div class="figure">
<img src="pictures/example2a.png" alt="Solution to Example 2" /><p class="caption">Solution to Example 2</p>
</div>
<h2 id="staircase-plot">Staircase Plot</h2>
<p>Simulates output of Zero-Order-Hold (ZOH) or Digital Analogue Converter (DAC)</p>
<div class="figure">
<img src="pictures/example2b.png" alt="Solution to Example 2 as DAC Output" /><p class="caption">Solution to Example 2 as DAC Output</p>
</div>
<h2 id="example-3">Example 3</h2>
<p>Karris example 9.6: use the partial fraction expansion method to to compute the inverse z-transform of</p>
<p><span class="math">\[F(z) = \frac{z + 1}{(z-1)(z^2 + 2z + 2)}\]</span></p>
<h2 id="answer-to-example-3">Answer to Example 3</h2>
<p><span class="math">\[f[n] = -0.5\delta[n] + 0.4 + \frac{(\sqrt{2})^n}{10}\cos \frac{3n\pi}{4} -
\frac{3(\sqrt{2})^n}{10}\sin \frac{3n\pi}{4}\]</span></p>
<h2 id="matlab-solution-2">Matlab solution</h2>
<p>See <a href="https://github.com/cpjobling/EG-247-Resources/blob/master/week10/matlab/example3.m">example3.m</a></p>
<h2 id="lollipop-plot-1">Lollipop Plot</h2>
<div class="figure">
<img src="pictures/example3a.png" alt="Solution to Example 3" /><p class="caption">Solution to Example 3</p>
</div>
<h3 id="staircase-plot-1">Staircase Plot</h3>
<div class="figure">
<img src="pictures/example3b.png" alt="Solution to Example 3 as DAC Output" /><p class="caption">Solution to Example 3 as DAC Output</p>
</div>
<h1 id="inverse-z-transform-by-the-inversion-integral">Inverse Z-Transform by the Inversion Integral</h1>
<h2 id="inverse-z-transform-by-the-inversion-integral-1">Inverse Z-Transform by the Inversion Integral</h2>
<p>The inversion integral states that:</p>
<p><span class="math">\[f[n] = \frac{1}{{j2\pi }}\oint_C {F(z){z^{n - 1}}\,dz} \]</span></p>
<p>where <span class="math">\(C\)</span> is a closed curve that encloses all poles of the integrant.</p>
<p>This can (<em>apparently</em>) be solved by Cauchy's residue theorem!!</p>
<p>Fortunately (:-), this is beyond the scope of this module!</p>
<p>See Karris Section 9.6.2 (pp 9-29—9-33) if you want to find out more.</p>
<h1 id="inverse-z-transform-by-the-long-division">Inverse Z-Transform by the Long Division</h1>
<h2 id="inverse-z-transform-by-the-long-division-1">Inverse Z-Transform by the Long Division</h2>
<p>To apply this method, <span class="math">\(F(z)\)</span> must be a rational polynomial functuon, and the numerator and denominator must be polynomials arranged in descending powers of <span class="math">\(z\)</span>.</p>
<h2 id="example-4">Example 4</h2>
<p>Karris example 9.9: use the long division method to determine <span class="math">\(f[n]\)</span> for <span class="math">\(n = 0,\,1,\,\mathrm{and}\,2\)</span>, given that</p>
<p><span class="math">\[F(z) = \frac{1 + z^{-1} + 2z^{-2} + 3z^{-3}}{(1 - 0.25z^{-1})(1 - 0.5z^{-1})(1
- 0.75z^{-1})}\]</span></p>
<h2 id="answer-4">Answer 4</h2>
<p><span class="math">\(f[0] = 1\)</span>, <span class="math">\(f[1] = 5/2\)</span>, <span class="math">\(f[2] = 81/16\)</span>.</p>
<h2 id="matlab">Matlab</h2>
<p>See <a href="https://github.com/cpjobling/EG-247-Resources/blob/master/week10/matlab/example4.m">example4.m</a></p>
<pre class="sourceCode matlab"><code class="sourceCode matlab">sym_den =

z^<span class="fl">3</span> - (<span class="fl">3</span>*z^<span class="fl">2</span>)/<span class="fl">2</span> + (<span class="fl">11</span>*z)/<span class="fl">16</span> - <span class="fl">3</span>/<span class="fl">32</span>


fn =

    <span class="fl">1.0000</span>
    <span class="fl">2.5000</span>
    <span class="fl">5.0625</span>
    ....</code></pre>
<h2 id="combined-staircaselollipop-plot">Combined Staircase/Lollipop Plot</h2>
<div class="figure">
<img src="pictures/example4.png" alt="Combined Staircase/Lollipop Plot" /><p class="caption">Combined Staircase/Lollipop Plot</p>
</div>
<h2 id="methods-of-evaluation-of-the-inverse-z-transform">Methods of Evaluation of the Inverse Z-Transform</h2>
<table>
<colgroup>
<col width="22%" />
<col width="37%" />
<col width="40%" />
</colgroup>
<thead>
<tr class="header">
<th align="left"><strong>Method</strong></th>
<th align="left"><strong>Advantages</strong></th>
<th align="left"><strong>Disadvantages</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><p>Partial Fraction Expansion</p></td>
<td align="left"><ul>
<li>Most familiar.</li>
<li>Can use Matlab <code>residue</code> function.</li>
</ul></td>
<td align="left"><ul>
<li>Requires that <span class="math">\(F(z)\)</span> is a proper rational function.</li>
</ul></td>
</tr>
<tr class="even">
<td align="left"><p>Inversion Integral</p></td>
<td align="left"><ul>
<li>Can be used whether <span class="math">\(F(z)\)</span> is rational or not</li>
</ul></td>
<td align="left"><ul>
<li>Requires familiarity with the <em>Residues theorem</em> | | | | of complex variable analysis.</li>
</ul></td>
</tr>
<tr class="odd">
<td align="left"><p>Long Division</p></td>
<td align="left"><ul>
<li>Practical when only a small sequence of numbers is desired.</li>
<li>Useful when z-transform has no closed-form solution.</li>
<li>Can use Matlab <code>dimpulse</code> function to compute a large sequence of numbers.</li>
</ul></td>
<td align="left"><ul>
<li>Requires that <span class="math">\(F(z)\)</span> is a proper rational</li>
<li>Division may be endless.</li>
</ul></td>
</tr>
</tbody>
</table>
<h2 id="summary">Summary</h2>
<ul>
<li>Inverse Z-Transform</li>
<li>Examples using PFE</li>
<li>Examples using Long Division</li>
<li>Analysis in Matlab</li>
</ul>
<p><em>Next time</em></p>
<ul>
<li>DT transfer functions, continuous system equivalents, and modelling DT systems in Matlab and Simulink.</li>
</ul>
<h2 id="homework">Homework</h2>
<p>Attempt the end of the chapter exercises 4-7 (Section 9.10) from Karris. Don't look at the answers until you have attempted the problems.</p>
<div class="footnotes">
<hr />
<ol>
<li id="fn1"><p>If complex, the poles and residues will be in complex conjugate pairs<a href="#fnref1">↩</a></p></li>
</ol>
</div>
</body>
</html>
