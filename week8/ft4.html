<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="generator" content="pandoc" />
  <title></title>
  <style type="text/css">code{white-space: pre;}</style>
  <style type="text/css">
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; }
code > span.dt { color: #902000; }
code > span.dv { color: #40a070; }
code > span.bn { color: #40a070; }
code > span.fl { color: #40a070; }
code > span.ch { color: #4070a0; }
code > span.st { color: #4070a0; }
code > span.co { color: #60a0b0; font-style: italic; }
code > span.ot { color: #007020; }
code > span.al { color: #ff0000; font-weight: bold; }
code > span.fu { color: #06287e; }
code > span.er { color: #ff0000; font-weight: bold; }
  </style>
  <script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>
</head>
<body>
<h1 id="introduction-to-filters">Introduction to Filters</h1>
<p>Dr Chris Jobling (<script type="text/javascript">
<!--
h='&#x73;&#x77;&#x61;&#110;&#x73;&#x65;&#x61;&#46;&#x61;&#x63;&#46;&#x75;&#x6b;';a='&#64;';n='&#x63;&#46;&#112;&#46;&#106;&#x6f;&#98;&#108;&#x69;&#110;&#x67;';e=n+a+h;
document.write('<a h'+'ref'+'="ma'+'ilto'+':'+e+'" clas'+'s="em' + 'ail">'+e+'<\/'+'a'+'>');
// -->
</script><noscript>&#x63;&#46;&#112;&#46;&#106;&#x6f;&#98;&#108;&#x69;&#110;&#x67;&#32;&#x61;&#116;&#32;&#x73;&#x77;&#x61;&#110;&#x73;&#x65;&#x61;&#32;&#100;&#x6f;&#116;&#32;&#x61;&#x63;&#32;&#100;&#x6f;&#116;&#32;&#x75;&#x6b;</noscript>)</p>
<p>Digital Technium 123</p>
<p>Office Hours: 12:00-13:00 Mondays</p>
<p>You can view the notes for this presentation in <a href="http://cpjobling.github.io/EG-247-Resources/week7/ft4.html">HTML</a> and <a href="http://cpjobling.github.io/EG-247-Resources/week7/ft4.pdf">PDF</a>.</p>
<p>The source code of this presentation is available in Markdown format from GitHub: <a href="https://github.com/cpjobling/EG-247-Resources/tree/master/week7/ft4.md">ft2.md</a>.</p>
<p>The GitHub repository <a href="https://github.com/cpjobling/EG-247-Resources">EG-247 Resources</a> also contains the source code for all the Matlab/Simulink examples and the Laboratory Exercises.</p>
<h2 id="scope-and-background-reading">Scope and Background Reading</h2>
<p>This session is Based on the section <strong>Filtering</strong> from Chapter 5 of <a href="http://site.ebrary.com/lib/swansea/docDetail.action?docID=10228195">Benoit Boulet, Fundamentals of Signals and Systems</a> from the <strong>Recommended Reading List</strong>.</p>
<p>This material is an introduction to analogue filters. You will find much more in-depth coverage on Pages 11-1â€”1-48 of Karris.</p>
<h2 id="agenda">Agenda</h2>
<ul>
<li>Frequency Selective Filters</li>
<li>Ideal low-pass filter</li>
<li>Butterworth low-pass filter</li>
<li>High-pass filter</li>
<li>Bandpass filter</li>
</ul>
<h2 id="introduction">Introduction</h2>
<ul>
<li>Filter design is an important application of Fourier transform</li>
<li>Filtering is a rich topic often taught in graduate courses so we give only an introduction.</li>
<li>Our introduction <em>will</em> illustrate the usefulness of the frequency domain viewpoint.</li>
<li>We will explore how filters can shape the spectrum of a signal.</li>
</ul>
<p>Other applications of the Fourier transform are sampling theory (introduced next week) and modulation.</p>
<h1 id="frequency-selective-filters">Frequency Selective Filters</h1>
<h2 id="frequency-selective-filters-1">Frequency Selective Filters</h2>
<p>An ideal frequency-selective filter is a system that let's the frequency components of a signal through undistorted while components at other components are completely cut off.</p>
<ul>
<li>The range of frequencies which are let through belong to the <strong>pass Band</strong></li>
<li>The range of frequencies which are cut-off by the filter are called the <strong>stopband</strong></li>
<li>A typical scenario where filtering is needed is when noise <span class="math">\(n(t)\)</span> is added to a signal <span class="math">\(x(t)\)</span> but that signal has most of its energy outside the bandwidth of a signal.</li>
</ul>
<h2 id="typical-filtering-problem">Typical filtering problem</h2>
<div class="figure">
<img src="pictures/filter1.png" alt="Typical filtering problem" /><p class="caption">Typical filtering problem</p>
</div>
<h2 id="signal">Signal</h2>
<div class="figure">
<img src="pictures/filter2.png" alt="Signal" /><p class="caption">Signal</p>
</div>
<h2 id="out-of-bandwidth-noise">Out-of Bandwidth Noise</h2>
<div class="figure">
<img src="pictures/filter3.png" alt="Noise" /><p class="caption">Noise</p>
</div>
<h2 id="signal-plus-noise">Signal plus Noise</h2>
<div class="figure">
<img src="pictures/filter4.png" alt="Signal plus noise" /><p class="caption">Signal plus noise</p>
</div>
<h2 id="filtering">Filtering</h2>
<div class="figure">
<img src="pictures/filter5.png" alt="filtering" /><p class="caption">filtering</p>
</div>
<h2 id="motivating-example">Motivating example</h2>
<p>Filtering in Matlab using 'built-in' filter design techniques by David Dorran</p>
<p><a href="http://www.youtube.com/watch?v=vfH5r4cKukg&amp;feature=share&amp;list=PLJ8LTUMGG9U4vAGind2_Bh4TUfgg1y0F4&amp;index=2">YouTube</a>.</p>
<p>For script see: <a href="http://dadorran.wordpress.com/2013/10/18/filter-design-using-matlab-demo/">Filter Design Using Matlab Demo</a></p>
<h1 id="ideal-low-pass-filter">Ideal Low-Pass Filter</h1>
<h2 id="ideal-low-pass-filter-1">Ideal Low-Pass Filter</h2>
<p>An ideal low pass filter cuts-off frequencies higher than its <em>cutoff frequency</em>, <span class="math">\(\omega_c\)</span>.</p>
<p><span class="math">\[{H_{{\rm{lp}}}}(\omega ) = \left\{ {\begin{array}{*{20}{c}}
{1,}&amp;{|\omega |{\kern 1pt} \, &lt; {\omega _c}}\\
{0,}&amp;{|\omega |{\kern 1pt} \, \ge {\omega _c}}
\end{array}} \right.\]</span></p>
<h2 id="frequency-response">Frequency response</h2>
<div class="figure">
<img src="pictures/ideal_lpf.png" alt="Ideal low-pass filter" /><p class="caption">Ideal low-pass filter</p>
</div>
<h2 id="impulse-response">Impulse response</h2>
<p><span class="math">\[{h_{{\rm{lp}}}}(t) = \frac{{{\omega _c}}}{\pi }{\mathop{\rm sinc}\nolimits}
\left( {\frac{{{\omega _c}}}{\pi }t} \right)\]</span></p>
<hr />
<div class="figure">
<img src="pictures/sinc.png" alt="Impulse response of ideal low-pass filter" /><p class="caption">Impulse response of ideal low-pass filter</p>
</div>
<h2 id="filtering-is-convolution">Filtering is Convolution</h2>
<p>The output of an LTI system with impulse response</p>
<p><span class="math">\[h(t) \Leftrightarrow H(\omega)\]</span></p>
<p>subject to an input signal</p>
<p><span class="math">\[x(t) \Leftrightarrow X(\omega)\]</span></p>
<p>is given by</p>
<p><span class="math">\[y(t) = h(t)*x(t) \Leftrightarrow Y(\omega) = H(\omega)X(\omega)\]</span></p>
<h2 id="issues-with-the-ideal-filter">Issues with the &quot;ideal&quot; filter</h2>
<p>This is the step response:</p>
<div class="figure">
<img src="pictures/step_r.png" alt="Step response of ideal filter" /><p class="caption">Step response of ideal filter</p>
</div>
<p>(reproduced from Boulet Fig. 5.23 p. 205)</p>
<div class="notes">
Ripples in the impulse response would be undesirable, and because the impulse response is non-causal it cannot actually be implemented.
</div>
<h1 id="butterworth-low-pass-filter">Butterworth low-pass filter</h1>
<h2 id="butterworth-low-pass-filter-1">Butterworth low-pass filter</h2>
<p>N-th Order Butterworth Filter</p>
<p><span class="math">\[\left| {{H_B}(\omega )} \right| = \frac{1}{{{{\left( {1 + {{\left(
{\frac{\omega }{{{\omega _c}}}} \right)}^{2N}}} \right)}^{\frac{1}{2}}}}}\]</span></p>
<p><strong>Remarks</strong></p>
<ul>
<li>DC gain is <span class="math">\(|H_B(j0)|=1\)</span></li>
<li>Attenuation at the cut-off frequency is <span class="math">\(|H_B(j\omega_c)|=1/\sqrt{2}\)</span> for any <span class="math">\(N\)</span></li>
</ul>
<p>More about the Butterworth filter: <a href="http://en.wikipedia.org/wiki/Butterworth_filter">Wikipedia Article</a></p>
<h2 id="example-1-second-order-bw-filter">Example 1: Second-order BW Filter</h2>
<p>The second-order Butterworth Filter is defined by its  (CE):</p>
<p><span class="math">\[p(s) = s^2 + \omega_c\sqrt{2}s+\omega_c^2 = 0^*\]</span></p>
<p>Calculate the roots of <span class="math">\(p(s)\)</span> (the poles of the filter transfer function) in both Cartesian and polar form.</p>
<div class="notes">
<strong>Note</strong>: This has the same characteristic as a control system with damping ratio <span class="math">\(\zeta = 1/\sqrt{2}\)</span> and <span class="math">\(\omega_n = \omega_c\)</span>!
</div>
<h2 id="example-2">Example 2</h2>
<p>Derive the differential equation relating the input <span class="math">\(x(t)\)</span> to output <span class="math">\(y(t)\)</span> of the 2nd-Order Butterworth low-pass filter with cutoff frequency <span class="math">\(\omega_c\)</span>.</p>
<h2 id="example-3">Example 3</h2>
<p>Determine the frequency response <span class="math">\(H_B(\omega)=Y(\omega)/X(\omega)\)</span></p>
<h2 id="magnitude-of-frequency-response-of-a-2nd-order-butterworth-filter">Magnitude of frequency response of a 2nd-order Butterworth Filter</h2>
<div class="figure">
<img src="pictures/blpmfr.png" alt="Magnitude response of Butterworth filter" /><p class="caption">Magnitude response of Butterworth filter</p>
</div>
<p>Generated with <a href="files/matlab/butter2_ex.m">butter2_ex.m</a></p>
<h2 id="bode-plot-of-a-2nd-order-butterworth-filter">Bode-plot of a 2nd-order Butterworth Filter</h2>
<div class="figure">
<img src="pictures/butter_bode.png" alt="Bode plot of Butterworth filter" /><p class="caption">Bode plot of Butterworth filter</p>
</div>
<p>Matlab:</p>
<pre class="sourceCode matlab"><code class="sourceCode matlab">wc = <span class="fl">100</span>;
H = tf(wc^<span class="fl">2</span>,[<span class="fl">1</span>, wc*sqrt(<span class="fl">2</span>), wc^<span class="fl">2</span>])
bode(H)</code></pre>
<p>Generated with <a href="files/matlab/butter2_ex.m">butter2_ex.m</a></p>
<h2 id="example-4">Example 4</h2>
<p>Determine the impulse response of the Butterworth filter.</p>
<p>You will find this Fourier transform pair useful:</p>
<p><span class="math">\[e^{-at}\sin\omega_0 t\;u_0(t) \Leftrightarrow \frac{\omega_0}{(j\omega +
a)^2+\omega_0^2}\]</span></p>
<h2 id="impulse-response-1">Impulse response</h2>
<div class="figure">
<img src="pictures/butter_imp.png" alt="Impulse response of Butterworth filter" /><p class="caption">Impulse response of Butterworth filter</p>
</div>
<p>Matlab:</p>
<pre class="sourceCode matlab"><code class="sourceCode matlab">impulse(H)</code></pre>
<p>Generated with <a href="files/matlab/butter2_ex.m">butter2_ex.m</a></p>
<h2 id="step-response-of-of-a-2nd-order-butterworth-filter">Step response of of a 2nd-order Butterworth Filter</h2>
<div class="figure">
<img src="pictures/butter_step.png" alt="Step response of Butterworth filter" /><p class="caption">Step response of Butterworth filter</p>
</div>
<p>Matlab:</p>
<pre class="sourceCode matlab"><code class="sourceCode matlab">step(H)</code></pre>
<p>Generated with <a href="files/matlab/butter2_ex.m">butter2_ex.m</a></p>
<h1 id="high-pass-filter">High-pass filter</h1>
<h2 id="high-pass-filter-1">High-pass filter</h2>
<p>An ideal high-pass filter cuts-off frequencies lower than its <em>cutoff frequency</em>, <span class="math">\(\omega_c\)</span>.</p>
<p><span class="math">\[{H_{{\rm{hp}}}}(\omega ) = \left\{ {\begin{array}{*{20}{c}}
{0,}&amp;{|\omega |{\kern 1pt} \, \le {\omega _c}}\\
{1,}&amp;{|\omega |{\kern 1pt} \, &gt; {\omega _c}}
\end{array}} \right.\]</span></p>
<h2 id="frequency-response-1">Frequency response</h2>
<div class="figure">
<img src="pictures/ideal_hpf.png" alt="Frequency respons of a high-pass filter" /><p class="caption">Frequency respons of a high-pass filter</p>
</div>
<h2 id="responses">Responses</h2>
<p><strong>Frequency response</strong></p>
<p><span class="math">\[H_{\mathrm{hp}}(\omega)=1-H_{\mathrm{lp}}(\omega)\]</span></p>
<p><strong>Impulse response</strong></p>
<p><span class="math">\[h_{\mathrm{hp}}(t)=\delta(t)-h_{\mathrm{lp}}(t)\]</span></p>
<h2 id="example-5">Example 5</h2>
<p>Determine the frequency response and impulse response of a 2nd-order butterworth highpass filter</p>
<h2 id="magnitude-of-frequency-response-of-a-2nd-order-butterworth-high-pass-filter">Magnitude of frequency response of a 2nd-order Butterworth High-Pass Filter</h2>
<div class="figure">
<img src="pictures/bhpmfr.png" alt="Magnitude of frequency response of a 2nd-order Butterworth high-pass filter" /><p class="caption">Magnitude of frequency response of a 2nd-order Butterworth high-pass filter</p>
</div>
<p>Generated with <a href="files/matlab/butter2_ex.m">butter2_ex.m</a></p>
<h1 id="bandpass-filter">Bandpass filter</h1>
<h2 id="bandpass-filter-1">Bandpass filter</h2>
<p>An ideal bandpass filter cuts-off frequencies lower than its first <em>cutoff frequency</em> <span class="math">\(\omega_{c1}\)</span>, and higher than its second <em>cutoff frequency</em> <span class="math">\(\omega_{c2}\)</span>.</p>
<p><span class="math">\[{H_{{\rm{bp}}}}(\omega ) = \left\{ {\begin{array}{*{20}{c}}
{1,}&amp;{{\omega _{c1}} &lt; \,|\omega |\, &lt; {\omega _{c2}}}\\
{0,}&amp;{{\rm{otherwise}}}
\end{array}} \right.\]</span></p>
<hr />
<div class="figure">
<img src="pictures/bbpmfr.png" alt="Bandpass filter" /><p class="caption">Bandpass filter</p>
</div>
<h2 id="bandpass-filter-design">Bandpass filter design</h2>
<p>A bandpass filter can be obtained by multiplying the frequency responses of a low-pass filter by a high-pass filter.</p>
<p><span class="math">\[H_{\mathrm{bp}}(\omega) = H_{\mathrm{hp}}(\omega)H_{\mathrm{lp}}(\omega)\]</span></p>
<ul>
<li><p>The high-pass filter should have cut-off frequency of <span class="math">\(\omega_{c1}\)</span></p></li>
<li><p>The low-pass filter should have cut-off frequency of <span class="math">\(\omega_{c2}\)</span></p></li>
</ul>
<h2 id="summary">Summary</h2>
<ul>
<li>Frequency Selective Filters</li>
<li>Ideal low-pass filter</li>
<li>Butterworth low-pass filter</li>
<li>High-pass filter</li>
<li>Bandpass filter</li>
</ul>
<p><em>Next Session</em> â€“ sampling theory</p>
<h2 id="lab-work">Lab Work</h2>
<p>In the lab we will look at frequency response analysis and filtering.</p>
</body>
</html>
